import { h, createState } from 'skara-js';

export function Timer() {
  const seconds = createState(0);
  const isRunning = createState(false);
  const intervalId = createState(null);

  const start = () => {
    if (!isRunning.get()) {
      isRunning.set(true);
      const id = setInterval(() => {
        seconds.set(seconds.get() + 1);
      }, 1000);
      intervalId.set(id);
    }
  };

  const pause = () => {
    if (isRunning.get()) {
      isRunning.set(false);
      clearInterval(intervalId.get());
      intervalId.set(null);
    }
  };

  const reset = () => {
    pause();
    seconds.set(0);
  };

  const formatTime = (totalSeconds) => {
    const mins = Math.floor(totalSeconds / 60);
    const secs = totalSeconds % 60;
    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
  };

  return h('div', { className: 'timer' },
    h('h2', null, 'Timer'),
    h('div', { className: 'timer-display' },
      h('span', { className: 'time-value' }, formatTime(seconds.get()))
    ),
    h('div', { className: 'timer-controls' },
      h('button', {
        onClick: isRunning.get() ? pause : start,
        className: `timer-btn ${isRunning.get() ? 'pause' : 'start'}`
      }, isRunning.get() ? 'Pause' : 'Start'),
      h('button', {
        onClick: reset,
        className: 'timer-btn reset'
      }, 'Reset')
    )
  );
}